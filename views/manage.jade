extends layout

block content
  link(rel='stylesheet', href='/stylesheets/manage.css')
  if isaddition || isshipped || iscreation
    div.banner.success
      p Successfully #{isaddition ? 'added' : (isshipped ? 'shipped' : 'created')}.
  div.center-block
    h1.nowrap #{title}
    h3 Code
    p.subtext #{code}
    if description
      h3 Description
      p.subtext #{description}
    h3 Participants
    if participants.length > 0
      ul.participant-list
        each val, index in participants
          li.participant
            if val.giftReceived
              div.badge-icon.success-status(title='Received')
            else if val.giftShipped
              div.badge-icon.in-progress-status(title='Shipped')
            else
              div.badge-icon.waiting-status(title='Awaiting shipping report')
            p(title="#{val.giftReceived ? 'Received' : (val.giftShipped ? 'Shipped' : 'Awaiting shipping report')}") #{val.name}
            if val.giftReceived
              div.badge.flex-right
                p Gift received.
            else if val.giftShipped
              div.badge.flex-right
                if val.estimatedDeliveryDate
                  p.btn-link.delivery-toggle(onmouseenter='document.querySelector("#delivery-popup-#{index}").style.display = "block"', onmouseleave='document.querySelector("#delivery-popup-#{index}").style.display = "none"') Estimated delivery
                    i.arrow.down
                  div.delivery-popup(id='delivery-popup-#{index}', style='display: none') #{val.estimatedDeliveryDate}
                a.btn-link(href='./report-received?code=#{code}') Report gift received 
            else
              a.flex-right.btn-link(href='./report-shipping?code=#{code}&recipient=#{val.name}') Report gift shipped
    else
      p.subtext No one has registered yet
    h3 Register For Event
    input.subtext(type='submit', value='Register', onclick='window.location.href="/registration?code=#{code}"')
    h3 Launch Event
    form(action='/start?code='+code, method='post')
      ul.form-style-1
        li
          label(for='passwd') Event Password
            span.required *
          input.field-long(name='passwd', type='text', id='passwd')
        li.button
          input(type='submit', value='Launch')
